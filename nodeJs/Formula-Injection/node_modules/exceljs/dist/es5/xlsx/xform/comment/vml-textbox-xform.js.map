{"version":3,"sources":["../../../../../lib/xlsx/xform/comment/vml-textbox-xform.js"],"names":["BaseXform","require","VmlTextboxXform","value","multiple","unit","parseFloat","toFixed","inset","split","map","margin","Number","conversionUnit","xmlStream","model","attributes","style","note","margins","Array","isArray","join","openNode","leafNode","closeNode","node","name","tag","reverseConversionUnit","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB;;IAEMC,e;;;;;;;;;;;;;mCAKWC,K,EAAOC,Q,EAAUC,I,EAAM;AACpC,uBAAUC,UAAU,CAACH,KAAD,CAAV,GAAoBC,QAAQ,CAACG,OAAT,CAAiB,CAAjB,CAA9B,SAAoDF,IAApD;AACD;;;0CAEqBG,K,EAAO;AAAA;;AAC3B,aAAO,CAACA,KAAK,IAAI,EAAV,EAAcC,KAAd,CAAoB,GAApB,EAAyBC,GAAzB,CAA6B,UAAAC,MAAM,EAAI;AAC5C,eAAOC,MAAM,CAACN,UAAU,CAAC,KAAI,CAACO,cAAL,CAAoBP,UAAU,CAACK,MAAD,CAA9B,EAAwC,GAAxC,EAA6C,EAA7C,CAAD,CAAV,CAA6DJ,OAA7D,CAAqE,CAArE,CAAD,CAAb;AACD,OAFM,CAAP;AAGD;;;2BAEMO,S,EAAWC,K,EAAO;AAAA;;AACvB,UAAMC,UAAU,GAAG;AACjBC,QAAAA,KAAK,EAAE;AADU,OAAnB;;AAGA,UAAIF,KAAK,IAAIA,KAAK,CAACG,IAAnB,EAAyB;AAAA,mBACTH,KAAK,CAACG,IAAN,IAAcH,KAAK,CAACG,IAAN,CAAWC,OADhB;AAAA,YAClBX,KADkB,QAClBA,KADkB;;AAEvB,YAAIY,KAAK,CAACC,OAAN,CAAcb,KAAd,CAAJ,EAA0B;AACxBA,UAAAA,KAAK,GAAGA,KAAK,CACVE,GADK,CACD,UAAAC,MAAM,EAAI;AACb,mBAAO,MAAI,CAACE,cAAL,CAAoBF,MAApB,EAA4B,EAA5B,EAAgC,IAAhC,CAAP;AACD,WAHK,EAILW,IAJK,CAIA,GAJA,CAAR;AAKD;;AACD,YAAId,KAAJ,EAAW;AACTQ,UAAAA,UAAU,CAACR,KAAX,GAAmBA,KAAnB;AACD;AACF;;AACDM,MAAAA,SAAS,CAACS,QAAV,CAAmB,WAAnB,EAAgCP,UAAhC;AACAF,MAAAA,SAAS,CAACU,QAAV,CAAmB,KAAnB,EAA0B;AAACP,QAAAA,KAAK,EAAE;AAAR,OAA1B;AACAH,MAAAA,SAAS,CAACW,SAAV;AACD;;;8BAESC,I,EAAM;AACd,cAAQA,IAAI,CAACC,IAAb;AACE,aAAK,KAAKC,GAAV;AACE,eAAKb,KAAL,GAAa;AACXP,YAAAA,KAAK,EAAE,KAAKqB,qBAAL,CAA2BH,IAAI,CAACV,UAAL,CAAgBR,KAA3C;AADI,WAAb;AAGA,iBAAO,IAAP;;AACF;AACE,iBAAO,IAAP;AAPJ;AASD;;;gCAEW,CAAE;;;+BAEHmB,I,EAAM;AACf,cAAQA,IAAR;AACE,aAAK,KAAKC,GAAV;AACE,iBAAO,KAAP;;AACF;AACE,iBAAO,IAAP;AAJJ;AAMD;;;wBAzDS;AACR,aAAO,WAAP;AACD;;;;EAH2B5B,S;;AA6D9B8B,MAAM,CAACC,OAAP,GAAiB7B,eAAjB","sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nclass VmlTextboxXform extends BaseXform {\r\n  get tag() {\r\n    return 'v:textbox';\r\n  }\r\n\r\n  conversionUnit(value, multiple, unit) {\r\n    return `${parseFloat(value) * multiple.toFixed(2)}${unit}`;\r\n  }\r\n\r\n  reverseConversionUnit(inset) {\r\n    return (inset || '').split(',').map(margin => {\r\n      return Number(parseFloat(this.conversionUnit(parseFloat(margin), 0.1, '')).toFixed(2));\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    const attributes = {\r\n      style: 'mso-direction-alt:auto',\r\n    };\r\n    if (model && model.note) {\r\n      let {inset} = model.note && model.note.margins;\r\n      if (Array.isArray(inset)) {\r\n        inset = inset\r\n          .map(margin => {\r\n            return this.conversionUnit(margin, 10, 'mm');\r\n          })\r\n          .join(',');\r\n      }\r\n      if (inset) {\r\n        attributes.inset = inset;\r\n      }\r\n    }\r\n    xmlStream.openNode('v:textbox', attributes);\r\n    xmlStream.leafNode('div', {style: 'text-align:left'});\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          inset: this.reverseConversionUnit(node.attributes.inset),\r\n        };\r\n        return true;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose(name) {\r\n    switch (name) {\r\n      case this.tag:\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = VmlTextboxXform;\r\n"],"file":"vml-textbox-xform.js"}