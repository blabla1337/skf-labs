{"version":3,"sources":["../../../lib/doc/image.js"],"names":["colCache","require","Anchor","Image","worksheet","model","type","imageId","hyperlinks","range","tl","br","ext","editAs","Error","decoded","decode","col","left","row","top","right","bottom","module","exports"],"mappings":";;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,UAAD,CAAtB;;IAEME,K;AACJ,iBAAYC,SAAZ,EAAuBC,KAAvB,EAA8B;AAAA;;AAC5B,SAAKD,SAAL,GAAiBA,SAAjB;AACA,SAAKC,KAAL,GAAaA,KAAb;AACD;;;;wBAEW;AACV,cAAQ,KAAKC,IAAb;AACE,aAAK,YAAL;AACE,iBAAO;AACLA,YAAAA,IAAI,EAAE,KAAKA,IADN;AAELC,YAAAA,OAAO,EAAE,KAAKA;AAFT,WAAP;;AAIF,aAAK,OAAL;AACE,iBAAO;AACLD,YAAAA,IAAI,EAAE,KAAKA,IADN;AAELC,YAAAA,OAAO,EAAE,KAAKA,OAFT;AAGLC,YAAAA,UAAU,EAAE,KAAKC,KAAL,CAAWD,UAHlB;AAILC,YAAAA,KAAK,EAAE;AACLC,cAAAA,EAAE,EAAE,KAAKD,KAAL,CAAWC,EAAX,CAAcL,KADb;AAELM,cAAAA,EAAE,EAAE,KAAKF,KAAL,CAAWE,EAAX,IAAiB,KAAKF,KAAL,CAAWE,EAAX,CAAcN,KAF9B;AAGLO,cAAAA,GAAG,EAAE,KAAKH,KAAL,CAAWG,GAHX;AAILC,cAAAA,MAAM,EAAE,KAAKJ,KAAL,CAAWI;AAJd;AAJF,WAAP;;AAWF;AACE,gBAAM,IAAIC,KAAJ,CAAU,oBAAV,CAAN;AAnBJ;AAqBD,K;4BAE6C;AAAA,UAAnCR,IAAmC,QAAnCA,IAAmC;AAAA,UAA7BC,OAA6B,QAA7BA,OAA6B;AAAA,UAApBE,KAAoB,QAApBA,KAAoB;AAAA,UAAbD,UAAa,QAAbA,UAAa;AAC5C,WAAKF,IAAL,GAAYA,IAAZ;AACA,WAAKC,OAAL,GAAeA,OAAf;;AAEA,UAAID,IAAI,KAAK,OAAb,EAAsB;AACpB,YAAI,OAAOG,KAAP,KAAiB,QAArB,EAA+B;AAC7B,cAAMM,OAAO,GAAGf,QAAQ,CAACgB,MAAT,CAAgBP,KAAhB,CAAhB;AACA,eAAKA,KAAL,GAAa;AACXC,YAAAA,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKE,SAAhB,EAA2B;AAACa,cAAAA,GAAG,EAAEF,OAAO,CAACG,IAAd;AAAoBC,cAAAA,GAAG,EAAEJ,OAAO,CAACK;AAAjC,aAA3B,EAAkE,CAAC,CAAnE,CADO;AAEXT,YAAAA,EAAE,EAAE,IAAIT,MAAJ,CAAW,KAAKE,SAAhB,EAA2B;AAACa,cAAAA,GAAG,EAAEF,OAAO,CAACM,KAAd;AAAqBF,cAAAA,GAAG,EAAEJ,OAAO,CAACO;AAAlC,aAA3B,EAAsE,CAAtE,CAFO;AAGXT,YAAAA,MAAM,EAAE;AAHG,WAAb;AAKD,SAPD,MAOO;AACL,eAAKJ,KAAL,GAAa;AACXC,YAAAA,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKE,SAAhB,EAA2BK,KAAK,CAACC,EAAjC,EAAqC,CAArC,CADO;AAEXC,YAAAA,EAAE,EAAEF,KAAK,CAACE,EAAN,IAAY,IAAIT,MAAJ,CAAW,KAAKE,SAAhB,EAA2BK,KAAK,CAACE,EAAjC,EAAqC,CAArC,CAFL;AAGXC,YAAAA,GAAG,EAAEH,KAAK,CAACG,GAHA;AAIXC,YAAAA,MAAM,EAAEJ,KAAK,CAACI,MAJH;AAKXL,YAAAA,UAAU,EAAEA,UAAU,IAAIC,KAAK,CAACD;AALrB,WAAb;AAOD;AACF;AACF;;;;;;AAGHe,MAAM,CAACC,OAAP,GAAiBrB,KAAjB","sourcesContent":["const colCache = require('../utils/col-cache');\r\nconst Anchor = require('./anchor');\r\n\r\nclass Image {\r\n  constructor(worksheet, model) {\r\n    this.worksheet = worksheet;\r\n    this.model = model;\r\n  }\r\n\r\n  get model() {\r\n    switch (this.type) {\r\n      case 'background':\r\n        return {\r\n          type: this.type,\r\n          imageId: this.imageId,\r\n        };\r\n      case 'image':\r\n        return {\r\n          type: this.type,\r\n          imageId: this.imageId,\r\n          hyperlinks: this.range.hyperlinks,\r\n          range: {\r\n            tl: this.range.tl.model,\r\n            br: this.range.br && this.range.br.model,\r\n            ext: this.range.ext,\r\n            editAs: this.range.editAs,\r\n          },\r\n        };\r\n      default:\r\n        throw new Error('Invalid Image Type');\r\n    }\r\n  }\r\n\r\n  set model({type, imageId, range, hyperlinks}) {\r\n    this.type = type;\r\n    this.imageId = imageId;\r\n\r\n    if (type === 'image') {\r\n      if (typeof range === 'string') {\r\n        const decoded = colCache.decode(range);\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, {col: decoded.left, row: decoded.top}, -1),\r\n          br: new Anchor(this.worksheet, {col: decoded.right, row: decoded.bottom}, 0),\r\n          editAs: 'oneCell',\r\n        };\r\n      } else {\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, range.tl, 0),\r\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\r\n          ext: range.ext,\r\n          editAs: range.editAs,\r\n          hyperlinks: hyperlinks || range.hyperlinks,\r\n        };\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = Image;\r\n"],"file":"image.js"}